name: vgc_policy
policy:
  _target_: vgc.policy.vgc_policy.VGCPolicy
  shape_meta: ${task.shape_meta}
  noise_scheduler:
    _target_: diffusers.schedulers.scheduling_ddpm.DDPMScheduler
    num_train_timesteps: 100
    beta_schedule: squaredcos_cap_v2
    clip_sample: true
    prediction_type: epsilon
  horizon: 16
  n_action_steps: 8
  n_obs_steps: 2
  num_inference_steps: 100
  obs_as_global_cond: true
  diffusion_step_embed_dim: 256
  down_dims:
  - 256
  - 512
  - 1024
  kernel_size: 5
  n_groups: 8
  condition_type: film
  d_point: 128
  dino_model_name: dinov2_vits14
training:
  device: cuda:0
  seed: 42
  debug: false
  resume: true
  lr: 0.0001
  weight_decay: 1.0e-06
  lr_scheduler: cosine
  lr_warmup_steps: 500
  num_epochs: 100
  gradient_accumulate_every: 1
  use_ema: true
  checkpoint_every: 10
  val_every: 10
  sample_every: 10
  max_train_steps: null
  max_val_steps: null
  tqdm_interval_sec: 1.0
dataloader:
  batch_size: 4
  num_workers: 4
  shuffle: true
  pin_memory: true
  persistent_workers: false
val_dataloader:
  batch_size: 4
  num_workers: 4
  shuffle: false
  pin_memory: true
  persistent_workers: false
optimizer:
  _target_: torch.optim.AdamW
  lr: ${training.lr}
  weight_decay: ${training.weight_decay}
  betas:
  - 0.95
  - 0.999
  eps: 1.0e-08
task:
  name: stack_blocks
  dataset:
    _target_: vgc.dataset.vgc_dataset.VGCDataset
    zarr_path: data/stack_blocks_two-demo_3d_vision_easy-100-ppi.zarr
    horizon: ${policy.horizon}
    pad_before: 1
    pad_after: 7
    seed: 42
    val_ratio: 0.02
    max_train_episodes: null
  shape_meta:
    action:
      shape:
      - 14
    obs:
      agent_pos:
        shape:
        - 32
      point_cloud:
        shape:
        - 1024
        - 6
      images:
        shape:
        - 2
        - 3
        - 224
        - 224
